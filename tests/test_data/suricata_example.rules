# Suricata rules taken from:
# https://rules.emergingthreats.net/open/suricata/rules/emerging-hunting.rules

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET HUNTING Possible Phishing - Form submitted to submit-form Form Hosting"; flow:established,to_server; http.method; content:"POST"; http.host; content:"submit-form.com"; endswith; classtype:credential-theft; sid:2030707; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2020_08_20, deployment Perimeter, former_category HUNTING, signature_severity Critical, tag Phishing, updated_at 2020_08_20, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET HUNTING HTTP POST to .php on Appspot Hosting - Possible Phishing"; flow:established,to_server; http.method; content:"POST"; http.uri; content:".php"; isdataat:!1,relative; http.host; content:".appspot.com"; isdataat:!1,relative; fast_pattern; classtype:misc-activity; sid:2030708; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2020_08_21, deployment Perimeter, former_category HUNTING, signature_severity Critical, tag Phishing, updated_at 2020_08_21, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET HUNTING HTTP POST to XYZ TLD Containing Pass - Possible Phishing"; flow:established,to_server; http.method; content:"POST"; http.host; content:".xyz"; endswith; fast_pattern; http.request_body; content:"pass"; nocase; classtype:misc-activity; sid:2031189; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2020_11_09, deployment Perimeter, former_category HUNTING, signature_severity Critical, tag Phishing, updated_at 2020_11_12, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET HUNTING Suspicious Glitch Hosted GET Request - Possible Phishing Landing"; flow:established,to_server; urilen:1; http.method; content:"GET"; http.host; content:".glitch.me"; fast_pattern; pcre:"/^[a-z]+\-[a-z]+\-[a-z]+\.glitch\.me$/"; classtype:social-engineering; sid:2031917; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2021_03_10, deployment Perimeter, deployment SSLDecrypt, former_category HUNTING, signature_severity Critical, tag Phishing, updated_at 2021_03_10, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert dns $HOME_NET any -> any any (msg:"ET HUNTING Suspicious Glitch Hosted DNS Request - Possible Phishing Landing"; dns.query; content:".glitch.me"; pcre:"/^[a-z]+\-[a-z]+\-[a-z]+\.glitch\.me$/"; classtype:social-engineering; sid:2031918; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2021_03_10, deployment Perimeter, former_category HUNTING, signature_severity Critical, tag Phishing, updated_at 2021_03_10, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET HUNTING Suspicious Glitch Hosted TLS SNI Request - Possible Phishing Landing"; flow:established,to_server; tls.sni; content:".glitch.me"; endswith; pcre:"/^[a-z]+\-[a-z]+\-[a-z]+\.glitch\.me$/"; classtype:social-engineering; sid:2031919; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2021_03_10, deployment Perimeter, former_category HUNTING, signature_severity Critical, tag Phishing, updated_at 2021_03_10, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert tls any any -> $HOME_NET any (msg:"ET HUNTING Observed Suspicious SSL Cert (Metasploit Self Signed CA)"; flow:from_server,established; tls.cert_issuer; content:"CN=MetasploitSelfSignedCA"; classtype:policy-violation; sid:2031932; rev:1; metadata:attack_target Client_and_Server, created_at 2021_03_11, deployment Perimeter, deployment Internet, deployment Internal, former_category POLICY, signature_severity Informational, updated_at 2021_03_11;)

alert tls any any -> $HOME_NET any (msg:"ET HUNTING Observed Suspicious SSL Cert (Metasploit in TLS Subject)"; flow:from_server,established; tls.cert_subject; content:"Metasploit"; nocase; classtype:policy-violation; sid:2031933; rev:2; metadata:attack_target Client_and_Server, created_at 2021_03_11, deployment Perimeter, deployment Internet, deployment Internal, former_category POLICY, signature_severity Informational, updated_at 2021_03_11;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET HUNTING Possible Phishing Page - Page Saved with SingleFile Extension"; flow:to_client,established; file.data; content:"Page saved with SingleFile"; fast_pattern; content:"|0d 0a 20|url|3a 20|"; distance:0; content:"|0d 0a 20|saved date|3a 20|"; distance:0; reference:url,chrome.google.com/webstore/detail/singlefile/mpiodijhokgodhhofbcjdecpffjipkle?hl=en; classtype:misc-activity; sid:2032082; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, created_at 2021_03_16, deployment Perimeter, former_category HUNTING, signature_severity Critical, tag Phishing, updated_at 2021_03_16, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1566, mitre_technique_name Phishing;)

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET HUNTING HTTP GET Request XOR Key 01"; flow:established,to_server; content:"|46 44 55 21 2e|"; startswith; fast_pattern; content:"|21 49 55 55 51 2e|"; distance:0; classtype:misc-activity; sid:2037965; rev:2; metadata:attack_target Client_and_Server, created_at 2022_08_09, deployment Perimeter, former_category HUNTING, performance_impact Low, signature_severity Informational, updated_at 2022_08_10, mitre_tactic_id TA0011, mitre_tactic_name Command_And_Control, mitre_technique_id T1001, mitre_technique_name Data_Obfuscation;)